(this["webpackJsonpuser-frontend"]=this["webpackJsonpuser-frontend"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c,o,a=n(0),r=n.n(a),i=n(31),s=n.n(i),d=(n(44),n(45),n(22)),u=n(38),l=n(26),f=n(2),b=n(30),j=n(20),h=n(32),m=n(29),p=n.n(m),v=n(37),x=function(){return console.log("client side socket hook chala"),v.a.connect("https://api.webrtcdemo.tk")},O=n(1),g={},w={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},k={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},y=n(27),C=y.a.div({display:"flex",padding:"1%",justifyContent:"space-between",maxWidth:700}),I=y.a.img({width:"200px",height:"150px",display:"block"}),S=y.a.span({fontWeight:"bold",fontSize:15,display:"block",border:"1px solid black",textAlign:"center"}),E=function(){return Object(O.jsx)("div",{children:Object(O.jsxs)(C,{className:"games-container",children:[Object(O.jsxs)(d.b,{to:"/viewers",children:[Object(O.jsx)(I,{src:"game-icon/sicbo-logo.png",alt:"roulette_icon"}),Object(O.jsx)(S,{children:"Viewers"})]}),Object(O.jsxs)(d.b,{to:"/broadcast-stream",children:[Object(O.jsx)(I,{src:"game-icon/sicbo-logo.png",alt:"roulette_icon"}),Object(O.jsx)(S,{children:"Broadcast Stream"})]})]})})},T=[{key:1,label:"Home",path:"/",component:E,hasNavbar:!0},{key:2,label:"broadcast-stream",path:"/broadcast-stream",component:function(){var e=x();Object(a.useEffect)((function(){e.on("answer",(function(e,t){g[e].setRemoteDescription(t)})),e.on("watcher",(function(n){var o=new RTCPeerConnection(w);g[n]=o,(c=t.srcObject).getTracks().forEach((function(e){return o.addTrack(e,c)})),o.onicecandidate=function(t){t.candidate&&e.emit("candidate",n,t.candidate)},o.createOffer().then((function(e){return o.setLocalDescription(e)})).then((function(){e.emit("offer",n,o.localDescription)}))})),e.on("candidate",(function(e,t){g[e].addIceCandidate(new RTCIceCandidate(t))})),e.on("disconnectPeer",(function(e){g[e].close(),delete g[e]})),window.onunload=window.onbeforeunload=function(){e.close()}}),[e]);var t=null,n=null,o=null;Object(a.useEffect)((function(){t=document.querySelector("video"),n=document.querySelector("select#audioSource"),o=document.querySelector("select#videoSource")}),[]),Object(a.useEffect)((function(){return function(){var e=t.srcObject.getTracks();e[0].stop(),e.forEach((function(e){return e.stop()}))}}),[t]),Object(a.useEffect)((function(){n&&o&&(n.onchange=s,o.onchange=s,s().then(r).then(i))}),[t,n,o]);var r=function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function i(e){window.deviceInfos=e;var t,c=Object(j.a)(e);try{for(c.s();!(t=c.n()).done;){var a=t.value,r=document.createElement("option");r.value=a.deviceId,"audioinput"===a.kind?(r.text=a.label||"Microphone ".concat(n.length+1),n.appendChild(r)):"videoinput"===a.kind&&(r.text=a.label||"Camera ".concat(o.length+1),o.appendChild(r))}}catch(i){c.e(i)}finally{c.f()}}function s(){window.stream&&window.stream.getTracks().forEach((function(e){e.stop()}));var e=n.value,t=o.value,c={audio:{deviceId:e?{exact:e}:void 0},video:{deviceId:t?{exact:t}:void 0}};return navigator.mediaDevices.getUserMedia(c).then(d).catch(u)}function d(c){window.stream=c,n.selectedIndex=Object(b.a)(n.options).findIndex((function(e){return e.text===c.getAudioTracks()[0].label})),o.selectedIndex=Object(b.a)(o.options).findIndex((function(e){return e.text===c.getVideoTracks()[0].label})),t.srcObject=c,e.emit("broadcaster")}function u(e){console.error("Error: ",e)}return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("section",{className:"select",children:[Object(O.jsx)("label",{htmlFor:"audioSource",children:"Audio source: "}),Object(O.jsx)("select",{id:"audioSource"})]}),Object(O.jsxs)("section",{className:"select",children:[Object(O.jsx)("label",{htmlFor:"videoSource",children:"Video source: "}),Object(O.jsx)("select",{id:"videoSource"})]}),Object(O.jsx)("video",{playsInline:!0,autoPlay:!0,muted:!0,style:{transform:"rotateY(180deg)"}})]})},hasNavbar:!0},{key:3,label:"viewers",path:"/viewers",component:function(){var e=x(),t=null;Object(a.useEffect)((function(){t=document.querySelector("video")}),[]),Object(a.useEffect)((function(){t&&(e.on("offer",(function(n,c){(o=new RTCPeerConnection(k)).setRemoteDescription(c).then((function(){return o.createAnswer()})).then((function(e){return o.setLocalDescription(e)})).then((function(){e.emit("answer",n,o.localDescription)})),o.ontrack=function(e){t.srcObject=e.streams[0]},o.onicecandidate=function(t){t.candidate&&e.emit("candidate",n,t.candidate)}})),e.on("candidate",(function(e,t){o.addIceCandidate(new RTCIceCandidate(t)).catch((function(e){return console.error(e)}))})),e.on("connect",(function(){e.emit("watcher")})),e.on("broadcaster",(function(){e.emit("watcher")})))}),[e,t]),Object(a.useEffect)((function(){window.onunload=window.onbeforeunload=function(){e.close(),o.close()}}),[window.onunload]);var n=function(e){t&&(t.muted=e)};return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("video",{playsInline:!0,autoPlay:!0,muted:!0,height:500,width:800,style:{transform:"rotateY(180deg)"}}),Object(O.jsx)("button",{id:"enable-audio",onClick:function(){return n(!1)},children:"Enable audio"}),Object(O.jsx)("button",{id:"enable-audio",onClick:function(){return n(!0)},children:"Disable audio"})]})},hasNavbar:!0}],D=T,F=["hasNavbar","component"],N=function(e){var t=e.hasNavbar,n=e.component;Object(l.a)(e,F);return t?Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(n,{})}):Object(O.jsx)(E,{})},P=["path","key"],R=function(){return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(f.c,{children:D.map((function(e){var t=e.path,n=e.key,c=Object(l.a)(e,P);return Object(O.jsx)(f.a,{path:t,exact:!0,element:Object(O.jsx)(N,Object(u.a)({path:t},c))},n)}))})})},q=function(){return Object(O.jsx)(d.a,{children:Object(O.jsx)(R,{})})};var A=function(){return Object(O.jsx)(q,{})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,57)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),o(e),a(e),r(e)}))};s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(A,{})}),document.getElementById("root")),L()}},[[56,1,2]]]);
//# sourceMappingURL=main.1b2702c0.chunk.js.map